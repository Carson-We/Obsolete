<?xml version="1.0" encoding="utf-8" ?>
<Contracts>
   <ContractTemplate>
      <Params>
         <Expression name="Probability" value="NumCompletions > 0 ? 0 : 20" />
      </Params>
      <Prereqs contracts="Race-Air-2" techNodes="jets2" />
      <Contract customer="schafer" id="Location-Ali" money="1000000" name="A.LI" unlockLocations="Ali 10L;Ali 28R" priority="100" probability="@Probability" expiration="30" deadline="120" difficulty="3">
         <Description
            short="Fly low around the desert base."
            long="Our systems detected you flying around the planet, and you seem like the perfect candidate for one of our missions. We are trying to validate the new ALI Base radars, fly for 10km under 150m above the ground while going at mach 1 or above near the base." />
         <Requirements>
            <TrackedLaunch>
               <Planet name="Droo" description="Be in Droo's SOI">
                  <Location locationId="Droo.Ali" description="Get in range of the Ali base" distanceMode="GreatCircle">
                     <Expression expression="150 > AltitudeAGL" description="AltitudeAGL &lt; 150m" displayExpression="AltitudeAGL" displayFormat="distance">
                        <Expression expression="MachNumber > 1" description="Mach > 1" displayExpression="MachNumber" displayFormat="n2">
                           <SurfaceDistance min="10000" description="Fly more than 10km" />
                        </Expression>
                     </Expression>
                  </Location>
               </Planet>
            </TrackedLaunch>
         </Requirements>
      </Contract>
   </ContractTemplate>

   <ContractTemplate>
      <Params>
         <Expression name="Probability" value="NumCompletions > 0 ? 0 : 20" />
      </Params>
      <Prereqs contracts="Droo-sat" />
      <Contract customer="schafer" id="Location-AliPad" money="2000000" name="Quick Deployment" unlockLocations="Ali Pad" priority="100" probability="@Probability" expiration="30" deadline="120" difficulty="3">
         <Description
            short="Get to orbit fast."
            long="We have been closely following your launch activity and you seem to be doing pretty well. Our necessities are a bit special though, we need you to prove you can work with us by getting to orbit fast." />
         <Requirements>
            <TrackedLaunch>
               <Planet name="Droo" description="Be in Droo's SOI">
                  <Expression expression="- 1 > TimeGrounded AND SurfaceVelocityVertical > 2" description="Lift off to start" />
                  <Timer max="300" description="You have 5 minutes" onFail="Stop">
                     <Orbit property="periapsis" value="80e3" op="Greater" />
                  </Timer>
               </Planet>
            </TrackedLaunch>
         </Requirements>
      </Contract>
   </ContractTemplate>

   <ContractTemplate>
      <Params>
         <Expression name="Probability" value="NumCompletions > 0 ? 0 : 100" />
      </Params>
      <Prereqs contracts="Location-Ali,Packages-research" />
      <Contract customer="schafer" id="Ali-delivery" money="200000" name="Explosives Delivery" priority="20" probability="@Probability" expiration="30" deadline="60" difficulty="3" flairText="Progression">
         <Description
            short="Bring some crates to the outpost."
            long="We need to bring a couple crates full of PETN to the desert base outpost. They are very delicate, so be sure to be careful with them, we don't need stunts for this one." />
         <Requirements>
            <TrackedLaunch>
               <Planet name="Droo" description="Be in Droo's SOI">
                  <Any num="4" description="Bring 4 crates to the Ali Outpost and leave them near the hangar" visibility="Hidden">
                     <Template.Repeat count="4">
                        <Payload payloadId="Payload-Package-Fragile" payloadName="Fragile Crate" listedInMenu="false" visibility="HiddenWhenPassed" destroyCraftOnComplete="Immediately">
                           <Location locationId="Droo.Ali.Outpost" listedInMenu="false">
                              <CraftExpression expression="Grounded" description="Make sure the box is grounded, be careful handling it!" listedInMenu="false" />
                           </Location>
                        </Payload>
                     </Template.Repeat>
                  </Any>
               </Planet>
            </TrackedLaunch>
         </Requirements>
      </Contract>
   </ContractTemplate>

   <ContractTemplate>
      <Params>
         <Expression name="Probability" value="5 / sqrt(NumCompletions + 1)" />
         <Expression name="Ceiling" value="round(1 + NumCompletions / 2)" />
         <Random name="Count" min="1" max="@Ceiling" round="1" />
         <Expression name="Scale" value="clamp(2 * NumCompletions, 0, 11)" />
         <Expression name="Difficulty" value="@Count / sqrt(NumCompletions + 1)" />
         <Expression name="Money" value="sqrt(@Difficulty) * @Count * 50e3" />
      </Params>
      <Prereqs contracts="Ali-delivery" />
      <Contract customer="schafer" id="Packages-outpost" money="@Money" name="Outpost Supplies" subtitle="@Count payload@Count:s" priority="5" probability="@Probability" difficulty="@Difficulty">
         <Description
            short="Bring some supplies to the Outpost."
            long="We need to bring some supplies to the Outpost, we don't care if you drive or fly them as long as they get there." />
         <Requirements>
            <TrackedLaunch>
               <Planet name="Droo" description="Be in Droo's SOI">
                  <Any num="@Count" description="Bring @Count payload@Count:s to the Outpost and leave them there" visibility="Hidden">
                     <Template.Repeat count="@Count">
                        <Template.Params>
                           <Random name="Index" min="0" max="@Scale" round="1" />
                           <List name="Version" index="@Index" values="A1;A2;A3;A4;B1;A5;B2;A6;B3;A7;A8;A9" />
                           <List name="Name" index="@Index" values="Small Light Box;Small Box;Small Heavy Box;Light Box;Light Barrel;Box;Barrel;Heavy Box;Heavy Barrel;Large Light Box;Large Box;Large Heavy Box" />
                        </Template.Params>
                        <Payload payloadId="Payload-Package-@Version" payloadName="@Name" visibility="HiddenWhenPassed" destroyCraftOnComplete="Immediately">
                           <Location locationId="Droo.Ali.Outpost" listedInMenu="false">
                              <CraftExpression expression="Grounded" description="Make sure the @Name is grounded" listedInMenu="false" />
                           </Location>
                        </Payload>
                     </Template.Repeat>
                  </Any>
               </Planet>
            </TrackedLaunch>
         </Requirements>
      </Contract>
   </ContractTemplate>

   <ContractTemplate>
      <Params>
         <Expression name="Probability" value="5 / sqrt(NumCompletions + 1)" />
         <Expression name="Ceiling" value="round(1 + NumCompletions / 2)" />
         <Random name="Count" min="1" max="@Ceiling" round="1" />
         <Expression name="Scale" value="clamp(2 * NumCompletions, 0, 11)" />
         <Expression name="Difficulty" value="@Count / sqrt(NumCompletions + 1)" />
         <Expression name="Money" value="sqrt(@Difficulty) * @Count * 25e3" />
      </Params>
      <Prereqs contracts="Ali-delivery" />
      <Contract customer="schafer" id="Packages-launchpad" money="@Money" name="Launchpad Supplies" subtitle="@Count payload@Count:s" priority="5" probability="@Probability" difficulty="@Difficulty">
         <Description
            short="Bring some supplies to the Launchpad."
            long="We need to bring some supplies to the Ali Launchpad, we don't care if you drive or fly them as long as they get there." />
         <Requirements>
            <TrackedLaunch>
               <Planet name="Droo" description="Be in Droo's SOI">
                  <Location locationId="Droo.Ali.Pad" range="-50" description="Hah! How smart! Don't start at the Launchpad" onFail="Stop" />
                  <Any num="@Count" description="Bring @Count payload@Count:s to the Ali Launchpad and leave them there" visibility="Hidden">
                     <Template.Repeat count="@Count">
                        <Template.Params>
                           <Random name="Index" min="0" max="@Scale" round="1" />
                           <List name="Version" index="@Index" values="A1;A2;A3;A4;B1;A5;B2;A6;B3;A7;A8;A9" />
                           <List name="Name" index="@Index" values="Small Light Box;Small Box;Small Heavy Box;Light Box;Light Barrel;Box;Barrel;Heavy Box;Heavy Barrel;Large Light Box;Large Box;Large Heavy Box" />
                        </Template.Params>
                        <Payload payloadId="Payload-Package-@Version" payloadName="@Name" visibility="HiddenWhenPassed" destroyCraftOnComplete="Immediately">
                           <Location locationId="Droo.Ali.Pad" listedInMenu="false">
                              <CraftExpression expression="Grounded" description="Return the Drood safely to the surface" visibility="HiddenWhenPassed" listedInMenu="false"/>
                              <Expression expression="2 > SurfaceVelocity" description="Return the Drood safely to the surface" visibility="HiddenWhenPassed" listedInMenu="false"/>
                           </Location>
                        </Payload>
                     </Template.Repeat>
                  </Any>
               </Planet>
            </TrackedLaunch>
         </Requirements>
      </Contract>
   </ContractTemplate>

   <ContractTemplate>
      <Params>
         <UniqueString name="UniqueDroodId1" />
         <UniqueString name="UniqueDroodId2" />
         <UniqueString name="UniqueDroodId3" />
         <UniqueString name="UniqueDroodId4" />
         <Random name="LatError" min="-0.1" max="0.1" />
         <Random name="LongError" min="-0.1" max="0.1" />
         <Expression name="RescueLat" value="-14.21 + @LatError"/>
         <Expression name="RescueLong" value="-90.24 + @LongError"/>
         <Expression name="Probability" value="NumCompletions > 0 ? 0 : 10" />
      </Params>
      <Prereqs contracts="Droo-Surface-Rescue-2,Location-Ali" />
      <Contract customer="schafer" id="Droo-Surface-Rescue-3" money="10000000" name="Droo Surface Rescue" subtitle="4 Droods on hills" priority="100" probability="@Probability" expiration="1" deadline="1" difficulty="3" flairText="Rescue">
         <Description
			   short="Private Jet Rescue"
			   long="Algernon's private jet has had an emergency landing on rough terrain. Luckily he wasn't on board, just his crew. Bring them back to the Ali Outpost quickly, no time to waste."/>
         <Requirements>
            <SpawnCraft craftName="Stranded Private Jet" craftXml="Droo-Rescue-Ground-4.xml" craftTrackingId="DrooGroundRescue-4" destroyOnContractClosed="true" visibility="Hidden">
               <SpawnCraft.LaunchLocation name="None" version="2" planetName="Droo" latitude="@RescueLat" longitude="@RescueLong" agl="2" heading="0" type="SurfaceLockedGround" />
               <SpawnCraft.Payload payloadId="DROOD1" mapTo="@UniqueDroodId1" />
               <SpawnCraft.Payload payloadId="DROOD2" mapTo="@UniqueDroodId2" />
               <SpawnCraft.Payload payloadId="DROOD3" mapTo="@UniqueDroodId3" />
               <SpawnCraft.Payload payloadId="DROOD4" mapTo="@UniqueDroodId4" />
            </SpawnCraft>
            <Timer min="1" listedInMenu="false" visibility="Hidden" />
            <TrackSpawnedCraft craftTrackingId="DrooGroundRescue-4" listedInMenu="false" visibility="Hidden" onFail="Stop">
               <SpawnedCraftDistance range="100" description="Get near the stranded Private Jet" autoSelectTarget="true" showTargetButton="true" />
            </TrackSpawnedCraft>
            <Any num="4" visibility="Hidden" description="Safely transport the 4 Droods to the Ali Base">
               <Template.Repeat count="4">
                  <Template.Params>
                     <Expression name="PayloadIndex" value="RepeatIndex" />
                     <List name="PayloadID" index="@PayloadIndex" values="@UniqueDroodId1;@UniqueDroodId2;@UniqueDroodId3;@UniqueDroodId4" />
                  </Template.Params>
                  <Payload mode="Recover" craftTrackingId="DrooGroundRescue-4" payloadId="@PayloadID" payloadName="Stranded Drood" description="Rescue the Drood from the damaged craft" allowWarp="true" visibility="HiddenWhenPassed" listedInMenu="false">
                     <Location locationId="Droo.Ali" description="Transport the Drood to the Ali Base" listedInMenu="false">
                        <CraftExpression expression="Grounded" description="Return the Drood safely to the surface" visibility="HiddenWhenPassed" listedInMenu="false"/>
                        <Expression expression="2 > SurfaceVelocity" description="Return the Drood safely to the surface" visibility="HiddenWhenPassed" listedInMenu="false"/>
                     </Location>
                  </Payload>
               </Template.Repeat>
            </Any>
         </Requirements>
      </Contract>
   </ContractTemplate>

   <ContractTemplate>
      <Params>
         <UniqueString name="UniqueDroodId1" />
         <Random name="LatError" min="-0.1" max="0.1" />
         <Random name="LongError" min="-0.1" max="0.1" />
         <Expression name="RescueLat" value="4.1 + @LatError"/>
         <Expression name="RescueLong" value="-138 + @LongError"/>
         <Expression name="Probability" value="NumCompletions > 0 ? 0 : 10" />
      </Params>
      <Prereqs contracts="Droo-Surface-Rescue-3,Location-Port" />
      <Contract customer="schafer" id="Droo-Surface-Rescue-4" money="400000" name="Droo Surface Rescue" subtitle="1 Drood at sea" priority="100" probability="@Probability" expiration="1" deadline="1" difficulty="2" flairText="Rescue">
         <Description
			   short="Inflatable Motorboat Rescue"
			   long="Somehow a Drood got their motorboat to break and is stranded at sea. They have asked me for help but I'm sure you are skilled enough to handle the situation yourself."/>
         <Requirements>
            <SpawnCraft craftName="Damaged Inflatable Motorboat" craftXml="Droo-Rescue-Ground-3.xml" craftTrackingId="DrooGroundRescue-3" destroyOnContractClosed="true" visibility="Hidden">
               <SpawnCraft.LaunchLocation name="None" version="2" planetName="Droo" latitude="@RescueLat" longitude="@RescueLong" agl="0" heading="0" type="SurfaceLockedGround" />
               <SpawnCraft.Payload payloadId="DROOD1" mapTo="@UniqueDroodId1" />
            </SpawnCraft>
            <Timer min="1" listedInMenu="false" visibility="Hidden" />
            <TrackSpawnedCraft craftTrackingId="DrooGroundRescue-3" listedInMenu="false" visibility="Hidden" onFail="Stop">
               <SpawnedCraftDistance range="100" description="Get near the damaged Inflatable Motorboat" autoSelectTarget="true" showTargetButton="true" />
            </TrackSpawnedCraft>
            <Payload mode="Recover" craftTrackingId="DrooGroundRescue-3" payloadId="@UniqueDroodId1" payloadName="Stranded Drood" description="Rescue the Drood from the damaged craft" allowWarp="true" visibility="HiddenWhenPassed">
               <Location locationId="Droo.DSC.Port" description="Transport the Drood to the DSC Port">
                  <CraftExpression expression="Grounded" description="Return the Drood safely to the surface" visibility="HiddenWhenPassed" listedInMenu="false"/>
                  <Expression expression="2 > SurfaceVelocity" description="Return the Drood safely to the surface" visibility="HiddenWhenPassed" listedInMenu="false"/>
               </Location>
            </Payload>
         </Requirements>
      </Contract>
   </ContractTemplate>

   <ContractTemplate>
      <Params>
         <UniqueString name="UniqueDroodId1" />
         <UniqueString name="UniqueDroodId2" />
         <UniqueString name="UniqueDroodId3" />
         <UniqueString name="UniqueDroodId4" />
         <UniqueString name="UniqueDroodId5" />
         <Random name="LatError" min="-0.001" max="0.001" />
         <Random name="LongError" min="-0.001" max="0.001" />
         <Expression name="RescueLat" value="80.82348 + @LatError"/>
         <Expression name="RescueLong" value="-149.44876 + @LongError"/>
         <Expression name="Probability" value="NumCompletions > 0 ? 0 : 10" />
      </Params>
      <Prereqs contracts="Droo-Surface-Rescue-4" />
      <Contract customer="schafer" id="Droo-Surface-Rescue-5" money="20000000" name="Droo Surface Rescue" subtitle="5 Droods at the North Pole" priority="100" probability="@Probability" expiration="1" deadline="7" difficulty="3" flairText="Rescue">
         <Description
			   short="Polar Exploration Vehicle Rescue"
			   long="Pricklespac sent a team of Droods to the pole and it seems like their Polar Exploration Vehicle fell into a crevasse and is inoperable. Bring them back to the Ali Base before they freeze."/>
         <Requirements>
            <SpawnCraft craftName="Damaged Polar Exploration Vehicle" craftXml="Droo-Rescue-Ground-5.xml" craftTrackingId="DrooGroundRescue-5" destroyOnContractClosed="true" visibility="Hidden">
               <SpawnCraft.LaunchLocation name="None" version="2" planetName="Droo" latitude="@RescueLat" longitude="@RescueLong" agl="2" heading="0" type="SurfaceLockedGround" />
               <SpawnCraft.Payload payloadId="DROOD1" mapTo="@UniqueDroodId1" />
               <SpawnCraft.Payload payloadId="DROOD2" mapTo="@UniqueDroodId2" />
               <SpawnCraft.Payload payloadId="DROOD3" mapTo="@UniqueDroodId3" />
               <SpawnCraft.Payload payloadId="DROOD4" mapTo="@UniqueDroodId4" />
               <SpawnCraft.Payload payloadId="DROOD5" mapTo="@UniqueDroodId5" />
            </SpawnCraft>
            <Timer min="1" listedInMenu="false" visibility="Hidden" />
            <TrackSpawnedCraft craftTrackingId="DrooGroundRescue-5" listedInMenu="false" visibility="Hidden" onFail="Stop">
               <SpawnedCraftDistance range="100" description="Get near the damaged Polar Exploration Vehicle" autoSelectTarget="true" showTargetButton="true" />
            </TrackSpawnedCraft>
            <Any num="5" visibility="Hidden" description="Safely transport the 5 Droods to the Ali Base">
               <Template.Repeat count="5">
                  <Template.Params>
                     <Expression name="PayloadIndex" value="RepeatIndex" />
                     <List name="PayloadID" index="@PayloadIndex" values="@UniqueDroodId1;@UniqueDroodId2;@UniqueDroodId3;@UniqueDroodId4;@UniqueDroodId5" />
                  </Template.Params>
                  <Payload mode="Recover" craftTrackingId="DrooGroundRescue-5" payloadId="@PayloadID" payloadName="Stranded Drood" description="Rescue the Drood from the damaged craft" allowWarp="true" visibility="HiddenWhenPassed" listedInMenu="false">
                     <Location locationId="Droo.Ali" description="Transport the Drood to the Ali Base" listedInMenu="false">
                        <CraftExpression expression="Grounded" description="Return the Drood safely to the surface" visibility="HiddenWhenPassed" listedInMenu="false"/>
                        <Expression expression="2 > SurfaceVelocity" description="Return the Drood safely to the surface" visibility="HiddenWhenPassed" listedInMenu="false"/>
                     </Location>
                  </Payload>
               </Template.Repeat>
            </Any>
         </Requirements>
      </Contract>
   </ContractTemplate>

   <ContractTemplate>
      <Params>
         <UniqueString name="UniqueDroodId1" />
         <UniqueString name="UniqueDroodId2" />
         <UniqueString name="UniqueDroodId3" />
         <UniqueString name="UniqueDroodId4" />
         <UniqueString name="UniqueDroodId5" />
         <UniqueString name="UniqueDroodId6" />
         <Random name="LatError" min="-0.001" max="0.001" />
         <Random name="LongError" min="-0.001" max="0.001" />
         <Expression name="RescueLat" value="25.29557 + @LatError"/>
         <Expression name="RescueLong" value="37.25991 + @LongError"/>
         <Expression name="Probability" value="NumCompletions > 0 ? 0 : 10" />
      </Params>
      <Prereqs contracts="Droo-Surface-Rescue-5,Location-DSC Short runway" />
      <Contract customer="schafer" id="Droo-Surface-Rescue-6" money="30000000" name="Droo Surface Rescue" subtitle="6 Droods at sea" priority="100" probability="@Probability" expiration="1" deadline="7" difficulty="3" flairText="Rescue">
         <Description
			   short="SimpleRCV Rescue"
			   long="Shotwell has called for help with a SimpleRCV that is stuck in the middle of nowhere. Can you safely transport them to the DSC Port? "/>
         <Requirements>
            <SpawnCraft craftName="Stranded SimpleRCV" craftXml="Droo-Rescue-Ground-6.xml" craftTrackingId="DrooGroundRescue-6" destroyOnContractClosed="true" visibility="Hidden">
               <SpawnCraft.LaunchLocation name="None" version="2" planetName="Droo" latitude="@RescueLat" longitude="@RescueLong" agl="2" heading="0" type="SurfaceLockedGround" />
               <SpawnCraft.Payload payloadId="DROOD1" mapTo="@UniqueDroodId1" />
               <SpawnCraft.Payload payloadId="DROOD2" mapTo="@UniqueDroodId2" />
               <SpawnCraft.Payload payloadId="DROOD3" mapTo="@UniqueDroodId3" />
               <SpawnCraft.Payload payloadId="DROOD4" mapTo="@UniqueDroodId4" />
               <SpawnCraft.Payload payloadId="DROOD5" mapTo="@UniqueDroodId5" />
               <SpawnCraft.Payload payloadId="DROOD6" mapTo="@UniqueDroodId6" />
            </SpawnCraft>
            <Timer min="1" listedInMenu="false" visibility="Hidden" />
            <TrackSpawnedCraft craftTrackingId="DrooGroundRescue-6" listedInMenu="false" visibility="Hidden" onFail="Stop">
               <SpawnedCraftDistance range="100" description="Get near the stranded SimpleRCV" autoSelectTarget="true" showTargetButton="true" />
            </TrackSpawnedCraft>
            <Any num="6" visibility="Hidden" description="Safely transport 6 Drood from the stranded craft to the DSC Port">
               <Template.Repeat count="6">
                  <Template.Params>
                     <Expression name="PayloadIndex" value="RepeatIndex" />
                     <List name="PayloadID" index="@PayloadIndex" values="@UniqueDroodId1;@UniqueDroodId2;@UniqueDroodId3;@UniqueDroodId4;@UniqueDroodId5;@UniqueDroodId6" />
                  </Template.Params>
                  <Payload mode="Recover" craftTrackingId="DrooGroundRescue-6" payloadId="@PayloadID" payloadName="Stranded Drood" description="Rescue the Drood from the damaged craft" allowWarp="true" visibility="HiddenWhenPassed" listedInMenu="false">
                     <Location locationId="Droo.DSC.Port" description="Transport the Drood to the DSC Port" visibility="HiddenWhenPassed" listedInMenu="false">
                        <CraftExpression expression="Grounded" description="Return the Drood safely to the surface" visibility="HiddenWhenPassed" listedInMenu="false"/>
                        <Expression expression="2 > SurfaceVelocity" description="Return the Drood safely to the surface" visibility="HiddenWhenPassed" listedInMenu="false"/>
                     </Location>
                  </Payload>
               </Template.Repeat>
            </Any>
         </Requirements>
      </Contract>
   </ContractTemplate>

   <ContractTemplate>
      <Params>
         <UniqueString name="UniqueDroodId1" />
         <Random name="Periapsis" min="100e3" max="200e3" round="1e3" />
         <Random name="Apoapsis" min="@Periapsis" max="300e3" round="1e3" />
         <Random name="AscendingNode" min="-180" max="180" round="0.1" />
         <Random name="Inclination" min="0" max="15" round="0.1" />
         <Random name="TrueAnomaly" min="0" max="360" round="1" />
         <Expression name="Probability" value="NumCompletions > 0 ? 0 : 10" />
      </Params>
      <Prereqs contracts="Location-AliPad" techNodes="crew2" />
      <Contract customer="schafer" id="Droo-Orbit-Rescue-1" money="10000000" name="Droo Orbit Rescue" subtitle="1 Drood in a SimpleCrew Spacecraft" priority="100" probability="@Probability" expiration="1" deadline="10" difficulty="2" flairText="Rescue">
         <Description
			   short="Rescue in Droo Orbit"
			   long="Yet another one of those cheap SimpleCrews still using the 100% sized docking ports is leaking again. This time it was crewed though, can you figure out how to bring the Drood back?" />
         <Requirements>
            <SpawnCraft craftName="Damaged SimpleCrew Spacecraft" craftXml="Droo-Rescue-Orbit-1.xml" craftTrackingId="DrooOrbitRescue-1" destroyOnContractClosed="true" visibility="Hidden">
               <SpawnCraft.OrbitLocation planetName="Droo" apoapsis="@Apoapsis" periapsis="@Periapsis" ascendingNode="@AscendingNode" inclination="@Inclination" argumentOfPeriapsis="0" trueAnomaly="@TrueAnomaly" includePlanetRotation="true" />
               <SpawnCraft.Payload payloadId="DROOD1" mapTo="@UniqueDroodId1" />
            </SpawnCraft>
            <Timer min="1" listedInMenu="false" visibility="Hidden" />
            <TrackSpawnedCraft craftTrackingId="DrooOrbitRescue-1" listedInMenu="false" visibility="Hidden" onFail="Stop">
               <SpawnedCraftDistance range="100" description="Get near the stranded craft" autoSelectTarget="true" showTargetButton="true" />
            </TrackSpawnedCraft>
            <Payload mode="Recover" craftTrackingId="DrooOrbitRescue-1" payloadId="@UniqueDroodId1" payloadName="Stranded Drood" description="Rescue the Drood from the stranded craft" allowWarp="true" visibility="HiddenWhenPassed">
               <Planet name="Droo" description="Bring the Drood down to Droo's surface" visibility="HiddenWhenPassed">
                  <CraftExpression expression="Grounded" description="Return the Drood safely to the surface" visibility="HiddenWhenPassed" listedInMenu="false"/>
                  <Expression expression="2 > SurfaceVelocity" description="Return the Drood safely to the surface" visibility="HiddenWhenPassed" listedInMenu="false"/>
               </Planet>
            </Payload>
         </Requirements>
      </Contract>
   </ContractTemplate>

   <ContractTemplate>
      <Params>
         <UniqueString name="UniqueDroodId1" />
         <UniqueString name="UniqueDroodId2" />
         <Random name="Periapsis" min="400e3" max="1e6" round="1e3" />
         <Random name="Apoapsis" min="@Periapsis" max="5e6" round="1e3" />
         <Random name="AscendingNode" min="-180" max="180" round="0.1" />
         <Random name="Inclination" min="15" max="45" round="0.1" />
         <Random name="TrueAnomaly" min="0" max="360" round="1" />
         <Expression name="Probability" value="NumCompletions > 0 ? 0 : 1" />
      </Params>
      <Prereqs contracts="Droo-Orbit-Rescue-1" />
      <!-- TODO: Require space tourist contract -->
      <Contract customer="schafer" id="Droo-Orbit-Rescue-2" money="20000000" name="Droo Orbit Rescue" subtitle="2 Droods in a Rapture Spacecraft" priority="100" probability="@Probability" expiration="1" deadline="10" difficulty="2" flairText="Rescue">
         <Description
			   short="Rescue in Droo Orbit"
			   long="Algernon sent a couple Droods on a space trip aboard of his flashy Rapture capsule and now they are stuck in space. He isn't going to rescue them, so it is your job now. They have a 200% size docking port, figure it out." />
         <Requirements>
            <SpawnCraft craftName="Stranded Rapture Spacecraft" craftXml="Droo-Rescue-Orbit-2.xml" craftTrackingId="DrooOrbitRescue-2" destroyOnContractClosed="true" visibility="Hidden">
               <SpawnCraft.OrbitLocation planetName="Droo" apoapsis="@Apoapsis" periapsis="@Periapsis" ascendingNode="@AscendingNode" inclination="@Inclination" argumentOfPeriapsis="0" trueAnomaly="@TrueAnomaly" includePlanetRotation="true" />
               <SpawnCraft.Payload payloadId="DROOD1" mapTo="@UniqueDroodId1" />
               <SpawnCraft.Payload payloadId="DROOD2" mapTo="@UniqueDroodId2" />
            </SpawnCraft>
            <Timer min="1" listedInMenu="false" visibility="Hidden" />
            <TrackSpawnedCraft craftTrackingId="DrooOrbitRescue-2" listedInMenu="false" visibility="Hidden" onFail="Stop">
               <SpawnedCraftDistance range="100" description="Get near the stranded craft" autoSelectTarget="true" showTargetButton="true" />
            </TrackSpawnedCraft>
            <Any num="2" visibility="Hidden" description="Bring 2 Droods from the stranded craft back to the surface of Droo">
               <Template.Repeat count="2">
                  <Template.Params>
                     <Expression name="PayloadIndex" value="RepeatIndex" />
                     <List name="PayloadID" index="@PayloadIndex" values="@UniqueDroodId1;@UniqueDroodId2" />
                  </Template.Params>
                  <Payload mode="Recover" craftTrackingId="DrooOrbitRescue-2" payloadId="@PayloadID" payloadName="Stranded Drood" description="Rescue the Drood from the stranded craft" allowWarp="true" visibility="HiddenWhenPassed" listedInMenu="false">
                     <Planet name="Droo" description="Bring the Drood down to Droo's surface" visibility="HiddenWhenPassed" listedInMenu="false">
                        <CraftExpression expression="Grounded" description="Return the Drood safely to the surface" visibility="HiddenWhenPassed" listedInMenu="false"/>
                        <Expression expression="2 > SurfaceVelocity" description="Return the Drood safely to the surface" visibility="HiddenWhenPassed" listedInMenu="false"/>
                     </Planet>
                  </Payload>
               </Template.Repeat>
            </Any>
         </Requirements>
      </Contract>
   </ContractTemplate>

   <ContractTemplate>
      <Params>
         <UniqueString name="UniqueDroodId1" />
         <UniqueString name="UniqueDroodId2" />
         <UniqueString name="UniqueDroodId3" />
         <Random name="Periapsis" min="80e6" max="90e6" round="1e3" />
         <Random name="Apoapsis" min="@Periapsis" max="150e6" round="1e3" />
         <Random name="AscendingNode" min="-180" max="180" round="0.1" />
         <Random name="Inclination" min="70" max="110" round="0.1" />
         <Random name="TrueAnomaly" min="0" max="360" round="1" />
         <Expression name="Probability" value="NumCompletions > 0 ? 0 : 1" />
      </Params>
      <Prereqs contracts="Droo-Orbit-Rescue-2,Heliosynch-orbit" />
      <Contract customer="schafer" id="Droo-Orbit-Rescue-3" money="30000000" name="Droo Orbit Rescue" subtitle="3 Drood in a Thermos Spaceplane" priority="100" probability="@Probability" expiration="1" deadline="10" difficulty="3" flairText="Rescue">
         <Description
			   short="Rescue in Droo Orbit"
			   long="A crew of 3 is stuck in an experimental shuttle we launched a couple weeks ago to a polar orbit to do some research I needed. It has a 400% size docking port in it, but if you can figure out how you can try to ride it back." />
         <Requirements>
            <SpawnCraft craftName="Stranded Thermos Spaceplane" craftXml="Droo-Rescue-Orbit-3.xml" craftTrackingId="DrooOrbitRescue-3" destroyOnContractClosed="true" visibility="Hidden">
               <SpawnCraft.OrbitLocation planetName="Droo" apoapsis="@Apoapsis" periapsis="@Periapsis" ascendingNode="@AscendingNode" inclination="@Inclination" argumentOfPeriapsis="0" trueAnomaly="@TrueAnomaly" includePlanetRotation="true" />
               <SpawnCraft.Payload payloadId="DROOD1" mapTo="@UniqueDroodId1" />
               <SpawnCraft.Payload payloadId="DROOD2" mapTo="@UniqueDroodId2" />
               <SpawnCraft.Payload payloadId="DROOD3" mapTo="@UniqueDroodId3" />
            </SpawnCraft>
            <Timer min="1" listedInMenu="false" visibility="Hidden" />
            <TrackSpawnedCraft craftTrackingId="DrooOrbitRescue-3" listedInMenu="false" visibility="Hidden" onFail="Stop">
               <SpawnedCraftDistance range="100" description="Get near the stranded craft" autoSelectTarget="true" showTargetButton="true" />
            </TrackSpawnedCraft>
            <Any num="3" visibility="Hidden" description="Bring 3 Droods from the stranded craft back to the surface of Droo">
               <Template.Repeat count="3">
                  <Template.Params>
                     <Expression name="PayloadIndex" value="RepeatIndex" />
                     <List name="PayloadID" index="@PayloadIndex" values="@UniqueDroodId1;@UniqueDroodId2;@UniqueDroodId3" />
                  </Template.Params>
                  <Payload mode="Recover" craftTrackingId="DrooOrbitRescue-3" payloadId="@PayloadID" payloadName="Stranded Drood" description="Rescue the Drood from the stranded craft" allowWarp="true" visibility="HiddenWhenPassed" listedInMenu="false">
                     <Planet name="Droo" description="Bring the Drood down to Droo's surface" visibility="HiddenWhenPassed" listedInMenu="false">
                        <CraftExpression expression="Grounded" description="Return the Drood safely to the surface" visibility="HiddenWhenPassed" listedInMenu="false"/>
                        <Expression expression="2 > SurfaceVelocity" description="Return the Drood safely to the surface" visibility="HiddenWhenPassed" listedInMenu="false"/>
                     </Planet>
                  </Payload>
               </Template.Repeat>
            </Any>
         </Requirements>
      </Contract>
   </ContractTemplate>

   <ContractTemplate>
      <Params>
         <UniqueString name="UniqueDroodId1" />
         <Random name="Periapsis" min="250e3" max="300e3" round="1e3" />
         <Random name="Apoapsis" min="@Periapsis" max="350e3" round="1e3" />
         <Random name="AscendingNode" min="-180" max="180" round="0.1" />
         <Random name="Inclination" min="0" max="25" round="0.1" />
         <Random name="TrueAnomaly" min="0" max="360" round="1" />
         <Expression name="Probability" value="NumCompletions > 0 ? 0 : 1" />
      </Params>
      <Prereqs contracts="Droo-Orbit-Rescue-2,Lunar-probe" />
      <Contract customer="schafer" id="Luna-Orbit-Rescue-1" money="75000000" name="Luna Orbit Rescue" subtitle="1 Drood in a Bruno Spacecraft" priority="100" probability="@Probability" expiration="1" deadline="20" difficulty="1" flairText="Rescue">
         <Description
			   short="Rescue in Luna Orbit"
			   long="Shotwell has asked for help bringing back a Drood stranded in orbit of Luna in a Bruno Capsule with a 100% size docking port. Don't mess this one up or it will be terrible PR." />
         <Requirements>
            <SpawnCraft craftName="Stranded Bruno Spacecraft" craftXml="Luna-Rescue-Orbit-1.xml" craftTrackingId="LunaOrbitRescue-1" destroyOnContractClosed="true" visibility="Hidden">
               <SpawnCraft.OrbitLocation planetName="Luna" apoapsis="@Apoapsis" periapsis="@Periapsis" ascendingNode="@AscendingNode" inclination="@Inclination" argumentOfPeriapsis="0" trueAnomaly="@TrueAnomaly" includePlanetRotation="true" />
               <SpawnCraft.Payload payloadId="DROOD1" mapTo="@UniqueDroodId1" />
            </SpawnCraft>
            <Timer min="1" listedInMenu="false" visibility="Hidden" />
            <TrackSpawnedCraft craftTrackingId="LunaOrbitRescue-1" listedInMenu="false" visibility="Hidden" onFail="Stop">
               <SpawnedCraftDistance range="100" description="Get near the stranded craft" autoSelectTarget="true" showTargetButton="true" />
            </TrackSpawnedCraft>
            <Payload mode="Recover" craftTrackingId="LunaOrbitRescue-1" payloadId="@UniqueDroodId1" payloadName="Stranded Drood" description="Rescue the Drood from the stranded craft" allowWarp="true" visibility="HiddenWhenPassed">
               <Planet name="Droo" description="Bring the Drood down to Droo's surface" visibility="HiddenWhenPassed">
                  <CraftExpression expression="Grounded" description="Return the Drood safely to the surface" visibility="HiddenWhenPassed" listedInMenu="false"/>
                  <Expression expression="2 > SurfaceVelocity" description="Return the Drood safely to the surface" visibility="HiddenWhenPassed" listedInMenu="false"/>
               </Planet>
            </Payload>
         </Requirements>
      </Contract>
   </ContractTemplate>

   <ContractTemplate>
      <Params>
         <UniqueString name="UniqueDroodId1" />
         <UniqueString name="UniqueDroodId2" />
         <Random name="Periapsis" min="6e3" max="7e3" round="1" />
         <Random name="Apoapsis" min="@Periapsis" max="10e3" round="1" />
         <Random name="AscendingNode" min="-180" max="180" round="0.1" />
         <Random name="Inclination" min="10" max="60" round="0.1" />
         <Random name="TrueAnomaly" min="0" max="360" round="1" />
         <Expression name="Probability" value="NumCompletions > 0 ? 0 : 1" />
      </Params>
      <Prereqs contracts="Luna-Orbit-Rescue-1" />
      <Contract customer="schafer" id="Luna-Orbit-Rescue-2" money="150000000" name="Luna Orbit Rescue" subtitle="2 Droods in a LM Ascent Stage" priority="100" probability="@Probability" expiration="1" deadline="20" difficulty="2" flairText="Rescue">
         <Description
			   short="Rescue in Luna Orbit"
			   long="Somehow Shotwell sent another mission to Luna, and it got stranded again. This time it is the Ascent Stage of their Luna Module, so it is on a really low orbit. It has a 100% size docking port, bring them back without crashing them into Luna." />
         <Requirements>
            <SpawnCraft craftName="Stranded Luna Module Ascent Stage" craftXml="Luna-Rescue-Orbit-2.xml" craftTrackingId="LunaOrbitRescue-2" destroyOnContractClosed="true" visibility="Hidden">
               <SpawnCraft.OrbitLocation planetName="Luna" apoapsis="@Apoapsis" periapsis="@Periapsis" ascendingNode="@AscendingNode" inclination="@Inclination" argumentOfPeriapsis="0" trueAnomaly="@TrueAnomaly" includePlanetRotation="true" />
               <SpawnCraft.Payload payloadId="DROOD1" mapTo="@UniqueDroodId1" />
               <SpawnCraft.Payload payloadId="DROOD2" mapTo="@UniqueDroodId2" />
            </SpawnCraft>
            <Timer min="1" listedInMenu="false" visibility="Hidden" />
            <TrackSpawnedCraft craftTrackingId="LunaOrbitRescue-2" listedInMenu="false" visibility="Hidden" onFail="Stop">
               <SpawnedCraftDistance range="100" description="Get near the stranded craft" autoSelectTarget="true" showTargetButton="true" />
            </TrackSpawnedCraft>
            <Any num="2" visibility="Hidden" description="Bring 2 Droods from the stranded craft back to the surface of Droo">
               <Template.Repeat count="2">
                  <Template.Params>
                     <Expression name="PayloadIndex" value="RepeatIndex" />
                     <List name="PayloadID" index="@PayloadIndex" values="@UniqueDroodId1;@UniqueDroodId2" />
                  </Template.Params>
                  <Payload mode="Recover" craftTrackingId="LunaOrbitRescue-2" payloadId="@PayloadID" payloadName="Stranded Drood" description="Rescue the Drood from the stranded craft" allowWarp="true" visibility="HiddenWhenPassed" listedInMenu="false">
                     <Planet name="Droo" description="Bring the Drood down to Droo's surface" visibility="HiddenWhenPassed" listedInMenu="false">
                        <CraftExpression expression="Grounded" description="Return the Drood safely to the surface" visibility="HiddenWhenPassed" listedInMenu="false"/>
                        <Expression expression="2 > SurfaceVelocity" description="Return the Drood safely to the surface" visibility="HiddenWhenPassed" listedInMenu="false"/>
                     </Planet>
                  </Payload>
               </Template.Repeat>
            </Any>
         </Requirements>
      </Contract>
   </ContractTemplate>

   <ContractTemplate>
      <Params>
         <UniqueString name="UniqueDroodId1" />
         <UniqueString name="UniqueDroodId2" />
         <UniqueString name="UniqueDroodId3" />
         <Random name="Periapsis" min="10e3" max="50e3" round="1e3" />
         <Random name="Apoapsis" min="5e6" max="6e6" round="1e3" />
         <Random name="AscendingNode" min="-180" max="180" round="0.1" />
         <Random name="Inclination" min="70" max="110" round="0.1" />
         <Random name="TrueAnomaly" min="0" max="360" round="1" />
         <Expression name="Probability" value="NumCompletions > 0 ? 0 : 1" />
      </Params>
      <Prereqs contracts="Luna-Orbit-Rescue-2" />
      <Contract customer="schafer" id="Luna-Orbit-Rescue-3" money="200000000" name="Luna Orbit Rescue" subtitle="3 Droods in a Nebula Spacecraft" priority="100" probability="@Probability" expiration="1" deadline="20" difficulty="3" flairText="Rescue">
         <Description
			   short="Rescue in Luna Orbit"
			   long="I have unsurprising news for you. Shotwell has lost yet another craft in orbit of Luna, this time a flashy new Nebula Capsule with a 200% size docking port. It is on a really extreme orbit, good luck trying to approach it." />
         <Requirements>
            <SpawnCraft craftName="Stranded Nebula Spacecraft" craftXml="Luna-Rescue-Orbit-3.xml" craftTrackingId="LunaOrbitRescue-3" destroyOnContractClosed="true" visibility="Hidden">
               <SpawnCraft.OrbitLocation planetName="Luna" apoapsis="@Apoapsis" periapsis="@Periapsis" ascendingNode="@AscendingNode" inclination="@Inclination" argumentOfPeriapsis="0" trueAnomaly="@TrueAnomaly" includePlanetRotation="true" />
               <SpawnCraft.Payload payloadId="DROOD1" mapTo="@UniqueDroodId1" />
               <SpawnCraft.Payload payloadId="DROOD2" mapTo="@UniqueDroodId2" />
               <SpawnCraft.Payload payloadId="DROOD3" mapTo="@UniqueDroodId3" />
            </SpawnCraft>
            <Timer min="1" listedInMenu="false" visibility="Hidden" />
            <TrackSpawnedCraft craftTrackingId="LunaOrbitRescue-3" listedInMenu="false" visibility="Hidden" onFail="Stop">
               <SpawnedCraftDistance range="100" description="Get near the stranded craft" autoSelectTarget="true" showTargetButton="true" />
            </TrackSpawnedCraft>
            <Any num="3" visibility="Hidden" description="Bring 3 Droods from the stranded craft back to the surface of Droo">
               <Template.Repeat count="3">
                  <Template.Params>
                     <Expression name="PayloadIndex" value="RepeatIndex" />
                     <List name="PayloadID" index="@PayloadIndex" values="@UniqueDroodId1;@UniqueDroodId2;@UniqueDroodId3" />
                  </Template.Params>
                  <Payload mode="Recover" craftTrackingId="LunaOrbitRescue-3" payloadId="@PayloadID" payloadName="Stranded Drood" description="Rescue the Drood from the stranded craft" allowWarp="true" visibility="HiddenWhenPassed" listedInMenu="false">
                     <Planet name="Droo" description="Bring the Drood down to Droo's surface" visibility="HiddenWhenPassed" listedInMenu="false">
                        <CraftExpression expression="Grounded" description="Return the Drood safely to the surface" visibility="HiddenWhenPassed" listedInMenu="false"/>
                        <Expression expression="2 > SurfaceVelocity" description="Return the Drood safely to the surface" visibility="HiddenWhenPassed" listedInMenu="false"/>
                     </Planet>
                  </Payload>
               </Template.Repeat>
            </Any>
         </Requirements>
      </Contract>
   </ContractTemplate>

   <ContractTemplate>
      <Params>
         <UniqueString name="UniqueDroodId1" />
         <Random name="LatError" min="-0.1" max="0.1" />
         <Random name="LongError" min="-0.1" max="0.1" />
         <Expression name="RescueLat" value="16.19450 + @LatError"/>
         <Expression name="RescueLong" value="61.65465 + @LongError"/>
         <Expression name="Probability" value="NumCompletions > 0 ? 0 : 1" />
      </Params>
      <Prereqs contracts="Lunar-lander,Luna-Orbit-Rescue-2" />
      <Contract customer="schafer" id="Luna-Surface-Rescue-1" money="150000000" name="Luna Surface Rescue" subtitle="1 Drood at Luna's maria" priority="100" probability="@Probability" expiration="1" deadline="30" difficulty="1" flairText="Rescue">
         <Description
			   short="Luna Module Rescue"
			   long="Yet another Luna Module has malfunctioned, this time on the surface of Luna, and is inoperable. Try to bring those Droods back home."/>
         <Requirements>
            <SpawnCraft craftName="Stranded Luna Module" craftXml="Luna-Rescue-Ground-1.xml" craftTrackingId="LunaGroundRescue-1" destroyOnContractClosed="true" visibility="Hidden">
               <SpawnCraft.LaunchLocation name="None" version="2" planetName="Luna" latitude="@RescueLat" longitude="@RescueLong" agl="0" heading="0" type="SurfaceLockedGround" />
               <SpawnCraft.Payload payloadId="DROOD1" mapTo="@UniqueDroodId1" />
            </SpawnCraft>
            <Timer min="1" listedInMenu="false" visibility="Hidden" />
            <TrackSpawnedCraft craftTrackingId="LunaGroundRescue-1" listedInMenu="false" visibility="Hidden" onFail="Stop">
               <SpawnedCraftDistance range="100" description="Get near the Stranded Luna Module" autoSelectTarget="true" showTargetButton="true" />
            </TrackSpawnedCraft>
            <Payload mode="Recover" craftTrackingId="LunaGroundRescue-1" payloadId="@UniqueDroodId1" payloadName="Stranded Drood" description="Rescue the Drood from the stranded craft" allowWarp="true" visibility="HiddenWhenPassed">
               <Planet name="Droo" description="Bring the Drood down to Droo's surface" visibility="HiddenWhenPassed">
                  <CraftExpression expression="Grounded" description="Return the Drood safely to the surface" visibility="HiddenWhenPassed" listedInMenu="false"/>
                  <Expression expression="2 > SurfaceVelocity" description="Return the Drood safely to the surface" visibility="HiddenWhenPassed" listedInMenu="false"/>
               </Planet>
            </Payload>
         </Requirements>
      </Contract>
   </ContractTemplate>

   <ContractTemplate>
      <Params>
         <UniqueString name="UniqueDroodId1" />
         <UniqueString name="UniqueDroodId2" />
         <Random name="LatError" min="-0.001" max="0.001" />
         <Random name="LongError" min="-0.001" max="0.001" />
         <Expression name="RescueLat" value="-32.22400 + @LatError"/>
         <Expression name="RescueLong" value="-166.50245 + @LongError"/>
         <Expression name="Probability" value="NumCompletions > 0 ? 0 : 1" />
      </Params>
      <Prereqs contracts="Luna-Surface-Rescue-1" techNodes="crew3" />
      <Contract customer="schafer" id="Luna-Surface-Rescue-2" money="300000000" name="Luna Surface Rescue" subtitle="2 Droods at maria edge" priority="100" probability="@Probability" expiration="1" deadline="5" difficulty="2" flairText="Rescue">
         <Description
			   short="LunaTown Base Rescue"
			   long="The LunaTown Base got one of its windows punctured somehow, you need to get there really quick to rescue the two Droods that survived the event."/>
         <Requirements>
            <SpawnCraft craftName="Stranded LunaTown Base" craftXml="Luna-Rescue-Ground-2.xml" craftTrackingId="LunaGroundRescue-2" destroyOnContractClosed="true" visibility="Hidden">
               <SpawnCraft.LaunchLocation name="None" version="2" planetName="Luna" latitude="@RescueLat" longitude="@RescueLong" agl="0" heading="0" type="SurfaceLockedGround" />
               <SpawnCraft.Payload payloadId="DROOD1" mapTo="@UniqueDroodId1" />
               <SpawnCraft.Payload payloadId="DROOD2" mapTo="@UniqueDroodId2" />
            </SpawnCraft>
            <Timer min="1" listedInMenu="false" visibility="Hidden" />
            <TrackSpawnedCraft craftTrackingId="LunaGroundRescue-2" listedInMenu="false" visibility="Hidden" onFail="Stop">
               <SpawnedCraftDistance range="100" description="Get near the Stranded LunaTown Base" autoSelectTarget="true" showTargetButton="true" />
            </TrackSpawnedCraft>
            <Any num="2" visibility="Hidden" description="Safely transport 2 Droods from the stranded craft back to Droo">
               <Template.Repeat count="2">
                  <Template.Params>
                     <Expression name="PayloadIndex" value="RepeatIndex" />
                     <List name="PayloadID" index="@PayloadIndex" values="@UniqueDroodId1;@UniqueDroodId2" />
                  </Template.Params>
                  <Payload mode="Recover" craftTrackingId="LunaGroundRescue-2" payloadId="@PayloadID" payloadName="Stranded Drood" description="Return the Drood to Droo" allowWarp="true" visibility="HiddenWhenPassed" listedInMenu="false">
                     <Planet name="Droo" description="Bring the Drood down to Droo's surface" visibility="HiddenWhenPassed" listedInMenu="false">
                        <CraftExpression expression="Grounded" description="Return the Drood safely to the surface" visibility="HiddenWhenPassed" listedInMenu="false"/>
                        <Expression expression="2 > SurfaceVelocity" description="Return the Drood safely to the surface" visibility="HiddenWhenPassed" listedInMenu="false"/>
                     </Planet>
                  </Payload>
               </Template.Repeat>
            </Any>
         </Requirements>
      </Contract>
   </ContractTemplate>

   <ContractTemplate>
      <Params>
         <UniqueString name="UniqueDroodId1" />
         <UniqueString name="UniqueDroodId2" />
         <UniqueString name="UniqueDroodId3" />
         <Random name="LatError" min="-0.1" max="0.1" />
         <Random name="LongError" min="-0.1" max="0.1" />
         <Expression name="RescueLat" value="-71.90797 + @LatError"/>
         <Expression name="RescueLong" value="-124.63360 + @LongError"/>
         <Expression name="Probability" value="NumCompletions > 0 ? 0 : 1" />
      </Params>
      <Prereqs contracts="Luna-Surface-Rescue-2" />
      <Contract customer="schafer" id="Luna-Surface-Rescue-3" money="500000000" name="Luna Surface Rescue" subtitle="3 Droods at the South Pole" priority="100" probability="@Probability" expiration="1" deadline="30" difficulty="3" flairText="Rescue">
         <Description
			   short="Drood Landing System Rescue"
			   long="Another of Algernon's toys has failed, this time the electrical system in a Lunar Lander. Now the crew can't launch and their elevator won't work, so you have to figure out a way to get them down to the surface and then bring them back home."/>
         <Requirements>
            <SpawnCraft craftName="Stranded Drood Landing System" craftXml="Luna-Rescue-Ground-3.xml" craftTrackingId="LunaGroundRescue-3" destroyOnContractClosed="true" visibility="Hidden">
               <SpawnCraft.LaunchLocation name="None" version="2" planetName="Luna" latitude="@RescueLat" longitude="@RescueLong" agl="0" heading="0" type="SurfaceLockedGround" />
               <SpawnCraft.Payload payloadId="DROOD1" mapTo="@UniqueDroodId1" />
               <SpawnCraft.Payload payloadId="DROOD2" mapTo="@UniqueDroodId2" />
               <SpawnCraft.Payload payloadId="DROOD3" mapTo="@UniqueDroodId3" />
            </SpawnCraft>
            <Timer min="1" listedInMenu="false" visibility="Hidden" />
            <TrackSpawnedCraft craftTrackingId="LunaGroundRescue-3" listedInMenu="false" visibility="Hidden" onFail="Stop">
               <SpawnedCraftDistance range="100" description="Get near the Stranded Drood Landing System" autoSelectTarget="true" showTargetButton="true" />
            </TrackSpawnedCraft>
            <Any num="3" visibility="Hidden" description="Safely transport 3 Droods from the stranded craft back to Droo">
               <Template.Repeat count="3">
                  <Template.Params>
                     <Expression name="PayloadIndex" value="RepeatIndex" />
                     <List name="PayloadID" index="@PayloadIndex" values="@UniqueDroodId1;@UniqueDroodId2;@UniqueDroodId3" />
                  </Template.Params>
                  <Payload mode="Recover" craftTrackingId="LunaGroundRescue-3" payloadId="@PayloadID" payloadName="Stranded Drood" description="Return the Drood to Droo" allowWarp="true" visibility="HiddenWhenPassed" listedInMenu="false">
                     <Planet name="Droo" description="Bring the Drood down to Droo's surface" visibility="HiddenWhenPassed" listedInMenu="false">
                        <CraftExpression expression="Grounded" description="Return the Drood safely to the surface" visibility="HiddenWhenPassed" listedInMenu="false"/>
                        <Expression expression="2 > SurfaceVelocity" description="Return the Drood safely to the surface" visibility="HiddenWhenPassed" listedInMenu="false"/>
                     </Planet>
                  </Payload>
               </Template.Repeat>
            </Any>
         </Requirements>
      </Contract>
   </ContractTemplate>

   <ContractTemplate>
      <Params>
         <Expression name="Probability" value="NumCompletions > 0 ? 0 : 1" />
      </Params>
      <Prereqs contracts="Observation" />
      <Contract customer="schafer" id="Removal" money="200000000" name="Classified" priority="0" probability="@Probability" expiration="1" deadline="1" difficulty="3">
         <Description
            short="Removing orbital debris."
            long="We have detected some potentially dangerous debris in orbit. You must eliminate it asap." />
         <Requirements>
            <SpawnCraft craftName="Debris" craftXml="Debris.xml" craftTrackingId="Debris" destroyOnContractClosed="true" visibility="Hidden">
               <SpawnCraft.OrbitLocation apoapsis="8803860" periapsis="8803600" ascendingNode="39" inclination="0.01" argumentOfPeriapsis="0" trueAnomaly="0" includePlanetRotation="true" />
            </SpawnCraft>
            <TrackSpawnedCraft craftTrackingId="Debris" listedInMenu="false" visibility="Hidden">
               <CraftEvent event="Destroyed" description="Destroy the debris by any means" />
            </TrackSpawnedCraft>
         </Requirements>
      </Contract>
   </ContractTemplate>
</Contracts>